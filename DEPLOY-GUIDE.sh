#!/bin/bash
#===============================================================================
# Guide de DÃ©ploiement Rapide vers Production
#===============================================================================

echo "==================================================="
echo "  DÃ©ploiement des Nouvelles FonctionnalitÃ©s"
echo "==================================================="
echo ""
echo "Les changements sont prÃªts dans Git mais doivent Ãªtre"
echo "dÃ©ployÃ©s sur votre serveur de production."
echo ""

# Ã‰tape 1
echo "ğŸ“¦ Ã‰TAPE 1 : Fusionner la branche (sur GitHub)"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "1. Allez sur GitHub :"
echo "   https://github.com/eme-data/prospection/pull/new/claude/viabilis-map-evolution-brBkE"
echo ""
echo "2. CrÃ©ez la Pull Request"
echo ""
echo "3. Mergez dans votre branche principale (main/master)"
echo ""

# Ã‰tape 2
echo "ğŸš€ Ã‰TAPE 2 : DÃ©ployer sur votre serveur"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "Connectez-vous Ã  votre serveur de production :"
echo ""
echo "ssh votre-utilisateur@votre-serveur.com"
echo ""
echo "Puis exÃ©cutez :"
echo ""
echo "cd /opt/prospection"
echo "sudo ./update.sh"
echo ""
echo "OU si update.sh n'existe pas encore :"
echo ""
echo "sudo systemctl stop prospection"
echo "sudo -u prospection git pull origin main"
echo "sudo -u prospection docker compose build --no-cache"
echo "sudo systemctl start prospection"
echo ""

# Alternative
echo "ğŸ“‹ ALTERNATIVE : DÃ©ploiement depuis une branche spÃ©cifique"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "Si vous voulez dÃ©ployer directement la branche sans merger :"
echo ""
echo "cd /opt/prospection"
echo "sudo systemctl stop prospection"
echo "sudo -u prospection git fetch origin"
echo "sudo -u prospection git checkout claude/viabilis-map-evolution-brBkE"
echo "sudo -u prospection git pull origin claude/viabilis-map-evolution-brBkE"
echo "sudo -u prospection docker compose build --no-cache"
echo "sudo systemctl start prospection"
echo ""

# VÃ©rification
echo "âœ… VÃ‰RIFICATION aprÃ¨s dÃ©ploiement"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "curl http://votre-serveur.com/health"
echo "sudo docker compose logs -f"
echo "sudo docker compose ps"
echo ""

# Informations
echo "ğŸ“ INFORMATIONS"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "Commit actuel : c536279"
echo "Branche       : claude/viabilis-map-evolution-brBkE"
echo "Version       : v2.1.0"
echo ""
echo "Nouvelles fonctionnalitÃ©s :"
echo "  - ğŸ“ Gestion de projets"
echo "  - ğŸ“Š Dashboard avec graphiques"
echo "  - ğŸ”” Historique & alertes"
echo "  - ğŸ“„ Rapports PDF"
echo "  - ğŸŒ DonnÃ©es enrichies"
echo "  - ğŸ¨ Mode sombre/clair"
echo ""
echo "==================================================="
